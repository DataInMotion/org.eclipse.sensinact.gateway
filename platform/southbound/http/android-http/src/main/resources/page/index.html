<!--
  ~ Copyright (c) 2017 CEA.
  ~ All rights reserved. This program and the accompanying materials
  ~ are made available under the terms of the Eclipse Public License v1.0
  ~ which accompanies this distribution, and is available at
  ~ http://www.eclipse.org/legal/epl-v10.html
  ~
  ~ Contributors:
  ~    CEA - initial API and implementation
  -->
<html>
<head>
    <style>
body {
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
}

.valueStyle {
    color: blue;
    font-family: verdana;
    font-size: 150%;
}

.titleStyle {
    color: black;
    font-family: courier;
    font-size: 200%;
}

.divStyle {
    position: fixed;
    bottom: 0;
    right: 0;
    width: 500px;
    border: 0px solid #73AD21;
}
</style>
</head>

<body>
<p id="motd" class="titleStyle" ></p>

<div class="divStyle">
    <p class="valueStyle" id="accelerationA" /><br/>
    <p class="valueStyle" id="accelerationB" /><br/>
    <p class="valueStyle" id="accelerationG" /><br/>
</div>
<div id="contentDiv">
</div>

</body>
<script>

function sendData(url,value) {
  var xhttp = new XMLHttpRequest();

  xhttp.onreadystatechange = function() {
    if (xhttp.readyState == 4 && xhttp.status == 200) {
      document.getElementById("contentDiv").innerHTML = xhttp.responseText;
    }
  };
  xhttp.open("POST", url, true);
  xhttp.setRequestHeader("Content-type", "application/json");
  xhttp.send(value);
}

var counter=0;

window.addEventListener("deviceorientation", function(event) {
  if(counter>50 && event.alpha!=null) {
  this.counter=0;
  document.getElementById("accelerationA").innerHTML = "Yaw "+(360-event.alpha);
  document.getElementById("accelerationB").innerHTML = "Pitch "+event.beta;
  document.getElementById("accelerationG").innerHTML = "Roll "+event.gamma;
  sendData("/android/","{\"alpha\":"+(360-event.alpha)+",\"beta\":"+event.beta+",\"epsilon\":"+event.gamma+"}");
  } else {
    this.counter=this.counter+1;
  }
}, true);

var ua = navigator.userAgent.toLowerCase();
var isAndroid = ua.indexOf("android") > -1;
if(isAndroid) {
  document.getElementById("motd").innerHTML = "Welcome to IoT week, your device is connected.";
}else {
  document.getElementById("motd").innerHTML = "Sorry this is NOT a compatible device.";
}

</script>
</html>
